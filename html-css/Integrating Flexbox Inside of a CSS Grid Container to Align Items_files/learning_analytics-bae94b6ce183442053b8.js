/*! For license information please see learning_analytics-bae94b6ce183442053b8.js.LICENSE.txt */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/packs/",n(n.s=30)}({0:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"appsignal",(function(){return u})),n.d(t,"trackError",(function(){return c})),n.d(t,"withErrorTracking",(function(){return f}));var r=n(1);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a={user_id:document.currentUserId},u=new r.a({key:"a1b2e86b-4c3e-4b7e-b603-591b394ae6f8",revision:e.env.APP_REVISION}),c=function(e,t){return u.sendError(e,i({},a,{location:window.location.href}))},f=function(e,t){return u.wrap(e,i({},a,{},t))}}.call(this,n(2))},1:function(e,t,n){"use strict";var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(t){i(t)}}function a(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function a(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(u(arguments[t]));return e}function f(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===e.length?e[0]:e.reduce((function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(void 0,c(n)))}}))}function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e){if(e)return Object.keys(e).forEach((function(t){"string"!==typeof e[t]&&"boolean"!==typeof e[t]&&"number"!==typeof e[t]&&(e[t]=JSON.stringify(e[t]))})),e}function d(e){if("undefined"!==typeof e.stacktrace||"undefined"!==typeof e["opera#sourceloc"]){var t=e.stacktrace;return(void 0===t?"":t).split("\n").filter((function(e){return""!==e}))}if(e.stack){var n=e.stack;return(void 0===n?"":n).split("\n").filter((function(e){return""!==e}))}return["No stacktrace available"]}var p=function(){function e(e){this._data=e}return e.prototype.toJSON=function(){return JSON.stringify(this._data)},e.prototype.serialize=function(){return this._data},e}(),v=function(){function e(){}return e.serialize=function(){return{transport:this.transport(),origin:this.origin()}},e.origin=function(){return"ReactNative"!==navigator.product||window.location?window.location.origin||window.location.protocol+"//"+window.location.hostname:""},e.transport=function(){return window.XDomainRequest?"XDomainRequest":window.XMLHttpRequest&&!window.fetch?"XMLHttpRequest":"fetch"},e.supportsPromises=function(){return"Promise"in window&&"resolve"in window.Promise&&"reject"in window.Promise&&"all"in window.Promise&&"race"in window.Promise&&(new window.Promise((function(t){e=t})),"function"===typeof e);var e},e}(),y=function(){function e(e){this.url=e}return e.prototype.send=function(e){var t=this;return new Promise((function(n,r){var o=new XDomainRequest,i=new RegExp("^https?:");o.onload=function(){return n({})},o.open("POST",t.url.replace(i,window.location.protocol)),setTimeout((function(){try{o.send(e)}catch(t){r(t)}}),0)}))},e}(),m=function(){function e(e){this.url=e}return e.prototype.send=function(e){var t=this;return new Promise((function(n,r){try{var o=new XMLHttpRequest;o.onreadystatechange=function(){o.readyState===XMLHttpRequest.DONE&&n({})},o.open("POST",t.url),o.send(e)}catch(i){r(i)}}))},e}(),g=function(){function e(e,t){this.url=e}return e.prototype.send=function(e){return i(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return[4,fetch(this.url,{method:"POST",body:e})];case 1:return t=r.sent(),n=t.statusText,[2,t.ok?Promise.resolve({}):Promise.reject({statusText:n})]}}))}))},e}(),b=function(){function e(e){this._uri=e.uri||"https://appsignal-endpoint.net/collect",this._apiKey=e.key,this._clientVersion=e.version,this._transport=this._createTransport()}return e.prototype.push=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this._transport.send(e.toJSON())];case 1:return t.sent(),[2,e]}}))}))},e.prototype._createTransport=function(){var e=this._url();switch(v.transport()){case"XDomainRequest":return new y(e);case"XMLHttpRequest":return new m(e);default:return new g(e)}},e.prototype._url=function(){var e,t=this._authorization();return this._uri+"?"+(e=t,Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&"))},e.prototype._authorization=function(){return{api_key:this._apiKey,version:this._clientVersion}},e}(),k=function(e){function t(t){return e.call(this,o({timestamp:Math.round((new Date).getTime()/1e3),namespace:"frontend",error:{name:"NullError",message:"No error has been set",backtrace:[]}},t))||this}return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.setAction=function(e){return e&&"string"===typeof e?(this._data.action=e,this):this},t.prototype.setNamespace=function(e){return e&&"string"===typeof e?(this._data.namespace=e,this):this},t.prototype.setError=function(e){return e?(this._data.error={name:e.name||"Error",message:e.message||"No message given",backtrace:d(e)},this):this},t.prototype.setTags=function(e){return this._data.tags=o(o({},this._data.tags),function(e){if(e)return Object.keys(e).forEach((function(t){"object"===l(e[t])&&(e[t]=JSON.stringify(e[t])),e[t]=String(e[t])})),e}(e)),this},t.prototype.setParams=function(e){return this._data.params=o(o({},this._data.params),e),this},t.prototype.setBreadcrumbs=function(e){return this._data.breadcrumbs=e,this},t}(p),w=function(){function e(e){this._data=e||[]}return e.prototype.clear=function(){this._data=[]},e.prototype.values=function(){return this._data},e.prototype.push=function(e){var t;(t=this._data).push.apply(t,c(e))},e.prototype.drain=function(){return s(this,(function(e){switch(e.label){case 0:return this._data.length>0?[4,this._data.shift()]:[3,2];case 1:return e.sent(),[3,0];case 2:return[2]}}))},e}(),j=function(){function e(e,t,n){this._retries=0,this._timerID=0,this._duration=0,this._api=t,this._queue=e,this.options=o({limit:5,initialDuration:1e3},n),this.reset()}return e.prototype.schedule=function(e){var t=this;void 0===e&&(e=this._duration);return window.setTimeout((function(){return i(t,void 0,void 0,(function(){var t,n,r,o,i,u,c;return s(this,(function(s){switch(s.label){case 0:s.trys.push([0,7,8,9]),t=a(this._queue.drain()),n=t.next(),s.label=1;case 1:if(n.done)return[3,6];if(!(r=n.value))return[2];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this._api.push(r)];case 3:return s.sent(),[3,5];case 4:return s.sent(),o=Math.floor(Math.pow(e,1.3)),this._retries=this._retries-1,0===this._retries?this.reset():(this._queue.push(r),this._timerID=this.schedule(o)),[2];case 5:return n=t.next(),[3,1];case 6:return[3,9];case 7:return i=s.sent(),u={error:i},[3,9];case 8:try{n&&!n.done&&(c=t.return)&&c.call(t)}finally{if(u)throw u.error}return[7];case 9:return this.reset(),[2]}}))}))}),e)},e.prototype.reset=function(){var e=this.options,t=e.limit,n=e.initialDuration;this._retries=t,this._duration=n},e}(),E=function(){function e(e){this.VERSION="1.2.0",this._hooks={decorators:Array(),overrides:Array()},this._env=v.serialize(),this._queue=new w(window.__APPSIGNAL_QUEUE__||[]);var t=e.key,n=e.uri,r=e.revision;r&&"string"!==typeof r&&(e.revision=String(r)),this._api=new b({key:t,uri:n,version:this.VERSION}),this.ignored=e.ignoreErrors||[],this._breadcrumbs=[],this._dispatcher=new j(this._queue,this._api),this._options=e}return e.prototype.send=function(e,t,n){var r=this;if(void 0===t&&(t={}),e instanceof Error||e instanceof k){if(0!==this.ignored.length){if(e instanceof Error&&this.ignored.some((function(t){return t.test(e.message)})))return void console.warn("[APPSIGNAL]: Ignored an error: "+e.message);if(e instanceof k){var o=e.serialize().error;if(o.message&&this.ignored.some((function(e){return e.test(o.message)})))return void console.warn("[APPSIGNAL]: Ignored a span: "+o.message)}}var i=e instanceof k?e:this._createSpanFromError(e);return this._hooks.decorators.length>0&&f.apply(void 0,c(this._hooks.decorators))(i),t&&i.setTags(t),n&&i.setNamespace(n),this._breadcrumbs.length>0&&i.setBreadcrumbs(this._breadcrumbs),this._hooks.overrides.length>0&&f.apply(void 0,c(this._hooks.overrides))(i),v.supportsPromises()?(this._breadcrumbs=[],this._api.push(i).catch((function(){r._queue.push(i),setTimeout((function(){return r._dispatcher.schedule()}),0)}))):void console.error("[APPSIGNAL]: Error not sent. A Promise polyfill is required.")}console.error("[APPSIGNAL]: Can't send error, given error is not a valid type")},e.prototype.sendError=function(e,t,n){return this.send(e,t,n)},e.prototype.use=function(e){e.call(this)},e.prototype.createSpan=function(e){var t=this._options,n=t.revision,r=void 0===n?"":n,o=t.namespace,i=new k({environment:this._env,revision:r});return o&&i.setNamespace(o),e&&"function"===typeof e&&e(i),i},e.prototype.wrap=function(e,t,n){return void 0===t&&(t={}),i(this,void 0,void 0,(function(){var r;return s(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,4]),[4,e()];case 1:return[2,o.sent()];case 2:return r=o.sent(),[4,this.sendError(r,t,n)];case 3:return o.sent(),[2,Promise.reject(r)];case 4:return[2]}}))}))},e.prototype.addDecorator=function(e){this._hooks.decorators.push(e)},e.prototype.addOverride=function(e){this._hooks.overrides.push(e)},e.prototype.demo=function(){var e=this._createSpanFromError(new Error("Hello world! This is an error used for demonstration purposes."));e.setAction("TestAction").setParams({path:"/hello",method:"GET"}).setTags({demo_sample:"true"}),this.send(e)},e.prototype.addBreadcrumb=function(e){var t=o(o({timestamp:Math.round((new Date).getTime()/1e3)},e),{metadata:h(e.metadata)});t.category?t.action?(20===this._breadcrumbs.length&&this._breadcrumbs.pop(),this._breadcrumbs.unshift(t)):console.warn("[APPSIGNAL]: Breadcrumb not added. `action` is missing."):console.warn("[APPSIGNAL]: Breadcrumb not added. `category` is missing.")},e.prototype._createSpanFromError=function(e){var t=this.createSpan();return t.setError(e),t},e}();t.a=E},13:function(e,t,n){(function(e){var n,r,o,i;function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==s(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){(function(t){e.exports=t.Phoenix=n(2)}).call(this,n(1))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==("undefined"===typeof window?"undefined":s(window))&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)})(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.r(t),n.d(t,"Channel",(function(){return x})),n.d(t,"Serializer",(function(){return A})),n.d(t,"Socket",(function(){return M})),n.d(t,"LongPoll",(function(){return q})),n.d(t,"Ajax",(function(){return D})),n.d(t,"Presence",(function(){return N}));var c="undefined"!=typeof self?self:null,f="undefined"!=typeof window?window:null,l=c||f||void 0,h="2.0.0",d=0,p=1,v=2,y=3,m="closed",g="errored",b="joined",k="joining",w="leaving",j="phx_close",E="phx_error",_="phx_join",O="phx_reply",S="phx_leave",T=[j,E,_,O,S],P="longpoll",R="websocket",C=function(e){return"function"==typeof e?e:function(){return e}},L=function(){function e(t,n,r,o){i(this,e),this.channel=t,this.event=n,this.payload=r||function(){return{}},this.receivedResp=null,this.timeout=o,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}return u(e,[{key:"resend",value:function(e){this.timeout=e,this.reset(),this.send()}},{key:"send",value:function(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}},{key:"receive",value:function(e,t){return this.hasReceived(e)&&t(this.receivedResp.response),this.recHooks.push({status:e,callback:t}),this}},{key:"reset",value:function(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}},{key:"matchReceive",value:function(e){var t=e.status,n=e.response;e.ref,this.recHooks.filter((function(e){return e.status===t})).forEach((function(e){return e.callback(n)}))}},{key:"cancelRefEvent",value:function(){this.refEvent&&this.channel.off(this.refEvent)}},{key:"cancelTimeout",value:function(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}},{key:"startTimeout",value:function(){var e=this;this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,(function(t){e.cancelRefEvent(),e.cancelTimeout(),e.receivedResp=t,e.matchReceive(t)})),this.timeoutTimer=setTimeout((function(){e.trigger("timeout",{})}),this.timeout)}},{key:"hasReceived",value:function(e){return this.receivedResp&&this.receivedResp.status===e}},{key:"trigger",value:function(e,t){this.channel.trigger(this.refEvent,{status:e,response:t})}}]),e}(),x=function(){function e(t,n,r){var o=this;i(this,e),this.state=m,this.topic=t,this.params=C(n||{}),this.socket=r,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new L(this,_,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new H((function(){o.socket.isConnected()&&o.rejoin()}),this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError((function(){return o.rejoinTimer.reset()}))),this.stateChangeRefs.push(this.socket.onOpen((function(){o.rejoinTimer.reset(),o.isErrored()&&o.rejoin()}))),this.joinPush.receive("ok",(function(){o.state=b,o.rejoinTimer.reset(),o.pushBuffer.forEach((function(e){return e.send()})),o.pushBuffer=[]})),this.joinPush.receive("error",(function(){o.state=g,o.socket.isConnected()&&o.rejoinTimer.scheduleTimeout()})),this.onClose((function(){o.rejoinTimer.reset(),o.socket.hasLogger()&&o.socket.log("channel","close ".concat(o.topic," ").concat(o.joinRef())),o.state=m,o.socket.remove(o)})),this.onError((function(e){o.socket.hasLogger()&&o.socket.log("channel","error ".concat(o.topic),e),o.isJoining()&&o.joinPush.reset(),o.state=g,o.socket.isConnected()&&o.rejoinTimer.scheduleTimeout()})),this.joinPush.receive("timeout",(function(){o.socket.hasLogger()&&o.socket.log("channel","timeout ".concat(o.topic," (").concat(o.joinRef(),")"),o.joinPush.timeout),new L(o,S,C({}),o.timeout).send(),o.state=g,o.joinPush.reset(),o.socket.isConnected()&&o.rejoinTimer.scheduleTimeout()})),this.on(O,(function(e,t){o.trigger(o.replyEventName(t),e)}))}return u(e,[{key:"join",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=e,this.joinedOnce=!0,this.rejoin(),this.joinPush}},{key:"onClose",value:function(e){this.on(j,e)}},{key:"onError",value:function(e){return this.on(E,(function(t){return e(t)}))}},{key:"on",value:function(e,t){var n=this.bindingRef++;return this.bindings.push({event:e,ref:n,callback:t}),n}},{key:"off",value:function(e,t){this.bindings=this.bindings.filter((function(n){return!(n.event===e&&(void 0===t||t===n.ref))}))}},{key:"canPush",value:function(){return this.socket.isConnected()&&this.isJoined()}},{key:"push",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw new Error("tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.join() before pushing events"));var r=new L(this,e,(function(){return t}),n);return this.canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}},{key:"leave",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=w;var n=function(){e.socket.hasLogger()&&e.socket.log("channel","leave ".concat(e.topic)),e.trigger(j,"leave")},r=new L(this,S,C({}),t);return r.receive("ok",(function(){return n()})).receive("timeout",(function(){return n()})),r.send(),this.canPush()||r.trigger("ok",{}),r}},{key:"onMessage",value:function(e,t,n){return t}},{key:"isLifecycleEvent",value:function(e){return T.indexOf(e)>=0}},{key:"isMember",value:function(e,t,n,r){return this.topic===e&&(!r||r===this.joinRef()||!this.isLifecycleEvent(t)||(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:e,event:t,payload:n,joinRef:r}),!1))}},{key:"joinRef",value:function(){return this.joinPush.ref}},{key:"sendJoin",value:function(e){this.state=k,this.joinPush.resend(e)}},{key:"rejoin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.isLeaving()||this.sendJoin(e)}},{key:"trigger",value:function(e,t,n,r){var o=this.onMessage(e,t,n,r);if(t&&!o)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");for(var i=0;i<this.bindings.length;i++){var s=this.bindings[i];s.event===e&&s.callback(o,n,r||this.joinRef())}}},{key:"replyEventName",value:function(e){return"chan_reply_".concat(e)}},{key:"isClosed",value:function(){return this.state===m}},{key:"isErrored",value:function(){return this.state===g}},{key:"isJoined",value:function(){return this.state===b}},{key:"isJoining",value:function(){return this.state===k}},{key:"isLeaving",value:function(){return this.state===w}}]),e}(),A={encode:function(e,t){var n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))},decode:function(e,t){var n=o(JSON.parse(e),5);return t({join_ref:n[0],ref:n[1],topic:n[2],event:n[3],payload:n[4]})}},M=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=r.timeout||1e4,this.transport=r.transport||l.WebSocket||q,this.defaultEncoder=A.encode,this.defaultDecoder=A.decode,this.closeWasClean=!1,this.unloaded=!1,this.binaryType=r.binaryType||"arraybuffer",this.transport!==q?(this.encode=r.encode||this.defaultEncoder,this.decode=r.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder),f&&f.addEventListener&&f.addEventListener("unload",(function(e){n.conn&&(n.unloaded=!0,n.abnormalClose("unloaded"))})),this.heartbeatIntervalMs=r.heartbeatIntervalMs||3e4,this.rejoinAfterMs=function(e){return r.rejoinAfterMs?r.rejoinAfterMs(e):[1e3,2e3,5e3][e-1]||1e4},this.reconnectAfterMs=function(e){return n.unloaded?100:r.reconnectAfterMs?r.reconnectAfterMs(e):[10,50,100,150,200,250,500,1e3,2e3][e-1]||5e3},this.logger=r.logger||null,this.longpollerTimeout=r.longpollerTimeout||2e4,this.params=C(r.params||{}),this.endPoint="".concat(t,"/").concat(R),this.vsn=r.vsn||h,this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new H((function(){n.teardown((function(){return n.connect()}))}),this.reconnectAfterMs)}return u(e,[{key:"protocol",value:function(){return location.protocol.match(/^https/)?"wss":"ws"}},{key:"endPointURL",value:function(){var e=D.appendParams(D.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return"/"!==e.charAt(0)?e:"/"===e.charAt(1)?"".concat(this.protocol(),":").concat(e):"".concat(this.protocol(),"://").concat(location.host).concat(e)}},{key:"disconnect",value:function(e,t,n){this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(e,t,n)}},{key:"connect",value:function(e){var t=this;e&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=C(e)),this.conn||(this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=function(){return t.onConnOpen()},this.conn.onerror=function(e){return t.onConnError(e)},this.conn.onmessage=function(e){return t.onConnMessage(e)},this.conn.onclose=function(e){return t.onConnClose(e)})}},{key:"log",value:function(e,t,n){this.logger(e,t,n)}},{key:"hasLogger",value:function(){return null!==this.logger}},{key:"onOpen",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.open.push([t,e]),t}},{key:"onClose",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.close.push([t,e]),t}},{key:"onError",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.error.push([t,e]),t}},{key:"onMessage",value:function(e){var t=this.makeRef();return this.stateChangeCallbacks.message.push([t,e]),t}},{key:"onConnOpen",value:function(){this.hasLogger()&&this.log("transport","connected to ".concat(this.endPointURL())),this.unloaded=!1,this.closeWasClean=!1,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach((function(e){return(0,o(e,2)[1])()}))}},{key:"resetHeartbeat",value:function(){var e=this;this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((function(){return e.sendHeartbeat()}),this.heartbeatIntervalMs))}},{key:"teardown",value:function(e,t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n||""):this.conn.close(),this.conn=null),e&&e()}},{key:"onConnClose",value:function(e){this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),clearInterval(this.heartbeatTimer),this.closeWasClean||this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((function(t){return(0,o(t,2)[1])(e)}))}},{key:"onConnError",value:function(e){this.hasLogger()&&this.log("transport",e),this.triggerChanError(),this.stateChangeCallbacks.error.forEach((function(t){return(0,o(t,2)[1])(e)}))}},{key:"triggerChanError",value:function(){this.channels.forEach((function(e){e.isErrored()||e.isLeaving()||e.isClosed()||e.trigger(E)}))}},{key:"connectionState",value:function(){switch(this.conn&&this.conn.readyState){case d:return"connecting";case p:return"open";case v:return"closing";default:return"closed"}}},{key:"isConnected",value:function(){return"open"===this.connectionState()}},{key:"remove",value:function(e){this.off(e.stateChangeRefs),this.channels=this.channels.filter((function(t){return t.joinRef()!==e.joinRef()}))}},{key:"off",value:function(e){for(var t in this.stateChangeCallbacks)this.stateChangeCallbacks[t]=this.stateChangeCallbacks[t].filter((function(t){var n=o(t,1)[0];return!e.includes(n)}))}},{key:"channel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new x(e,t,this);return this.channels.push(n),n}},{key:"push",value:function(e){var t=this;if(this.hasLogger()){var n=e.topic,r=e.event,o=e.payload,i=e.ref,s=e.join_ref;this.log("push","".concat(n," ").concat(r," (").concat(s,", ").concat(i,")"),o)}this.isConnected()?this.encode(e,(function(e){return t.conn.send(e)})):this.sendBuffer.push((function(){return t.encode(e,(function(e){return t.conn.send(e)}))}))}},{key:"makeRef",value:function(){var e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}},{key:"sendHeartbeat",value:function(){if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void this.abnormalClose("heartbeat timeout");this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef})}}},{key:"abnormalClose",value:function(e){this.closeWasClean=!1,this.conn.close(1e3,e)}},{key:"flushSendBuffer",value:function(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((function(e){return e()})),this.sendBuffer=[])}},{key:"onConnMessage",value:function(e){var t=this;this.decode(e.data,(function(e){var n=e.topic,r=e.event,i=e.payload,s=e.ref,a=e.join_ref;s&&s===t.pendingHeartbeatRef&&(t.pendingHeartbeatRef=null),t.hasLogger()&&t.log("receive","".concat(i.status||""," ").concat(n," ").concat(r," ").concat(s&&"("+s+")"||""),i);for(var u=0;u<t.channels.length;u++){var c=t.channels[u];c.isMember(n,r,i,a)&&c.trigger(r,i,s,a)}for(var f=0;f<t.stateChangeCallbacks.message.length;f++)(0,o(t.stateChangeCallbacks.message[f],2)[1])(e)}))}}]),e}(),q=function(){function e(t){i(this,e),this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(t),this.readyState=d,this.poll()}return u(e,[{key:"normalizeEndpoint",value:function(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+R),"$1/"+P)}},{key:"endpointURL",value:function(){return D.appendParams(this.pollEndpoint,{token:this.token})}},{key:"closeAndRetry",value:function(){this.close(),this.readyState=d}},{key:"ontimeout",value:function(){this.onerror("timeout"),this.closeAndRetry()}},{key:"poll",value:function(){var e=this;this.readyState!==p&&this.readyState!==d||D.request("GET",this.endpointURL(),"application/json",null,this.timeout,this.ontimeout.bind(this),(function(t){if(t){var n=t.status,r=t.token,o=t.messages;e.token=r}else n=0;switch(n){case 200:o.forEach((function(t){return e.onmessage({data:t})})),e.poll();break;case 204:e.poll();break;case 410:e.readyState=p,e.onopen(),e.poll();break;case 0:case 500:e.onerror(),e.closeAndRetry();break;default:throw new Error("unhandled poll status ".concat(n))}}))}},{key:"send",value:function(e){var t=this;D.request("POST",this.endpointURL(),"application/json",e,this.timeout,this.onerror.bind(this,"timeout"),(function(e){e&&200===e.status||(t.onerror(e&&e.status),t.closeAndRetry())}))}},{key:"close",value:function(e,t){this.readyState=y,this.onclose()}}]),e}(),D=function(){function e(){i(this,e)}return u(e,null,[{key:"request",value:function(e,t,n,r,o,i,s){if(l.XDomainRequest){var a=new XDomainRequest;this.xdomainRequest(a,e,t,r,o,i,s)}else{var u=l.XMLHttpRequest?new l.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.xhrRequest(u,e,t,n,r,o,i,s)}}},{key:"xdomainRequest",value:function(e,t,n,r,o,i,s){var a=this;e.timeout=o,e.open(t,n),e.onload=function(){var t=a.parseJSON(e.responseText);s&&s(t)},i&&(e.ontimeout=i),e.onprogress=function(){},e.send(r)}},{key:"xhrRequest",value:function(e,t,n,r,o,i,s,a){var u=this;e.open(t,n,!0),e.timeout=i,e.setRequestHeader("Content-Type",r),e.onerror=function(){a&&a(null)},e.onreadystatechange=function(){if(e.readyState===u.states.complete&&a){var t=u.parseJSON(e.responseText);a(t)}},s&&(e.ontimeout=s),e.send(o)}},{key:"parseJSON",value:function(e){if(!e||""===e)return null;try{return JSON.parse(e)}catch(t){return console&&console.log("failed to parse JSON response",e),null}}},{key:"serialize",value:function(e,t){var n=[];for(var o in e)if(e.hasOwnProperty(o)){var i=t?"".concat(t,"[").concat(o,"]"):o,s=e[o];"object"===r(s)?n.push(this.serialize(s,i)):n.push(encodeURIComponent(i)+"="+encodeURIComponent(s))}return n.join("&")}},{key:"appendParams",value:function(e,t){if(0===Object.keys(t).length)return e;var n=e.match(/\?/)?"&":"?";return"".concat(e).concat(n).concat(this.serialize(t))}}]),e}();D.states={complete:4};var N=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e);var o=r.events||{state:"presence_state",diff:"presence_diff"};this.state={},this.pendingDiffs=[],this.channel=t,this.joinRef=null,this.caller={onJoin:function(){},onLeave:function(){},onSync:function(){}},this.channel.on(o.state,(function(t){var r=n.caller,o=r.onJoin,i=r.onLeave,s=r.onSync;n.joinRef=n.channel.joinRef(),n.state=e.syncState(n.state,t,o,i),n.pendingDiffs.forEach((function(t){n.state=e.syncDiff(n.state,t,o,i)})),n.pendingDiffs=[],s()})),this.channel.on(o.diff,(function(t){var r=n.caller,o=r.onJoin,i=r.onLeave,s=r.onSync;n.inPendingSyncState()?n.pendingDiffs.push(t):(n.state=e.syncDiff(n.state,t,o,i),s())}))}return u(e,[{key:"onJoin",value:function(e){this.caller.onJoin=e}},{key:"onLeave",value:function(e){this.caller.onLeave=e}},{key:"onSync",value:function(e){this.caller.onSync=e}},{key:"list",value:function(t){return e.list(this.state,t)}},{key:"inPendingSyncState",value:function(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}}],[{key:"syncState",value:function(e,t,n,r){var o=this,i=this.clone(e),s={},a={};return this.map(i,(function(e,n){t[e]||(a[e]=n)})),this.map(t,(function(e,t){var n=i[e];if(n){var r=t.metas.map((function(e){return e.phx_ref})),u=n.metas.map((function(e){return e.phx_ref})),c=t.metas.filter((function(e){return u.indexOf(e.phx_ref)<0})),f=n.metas.filter((function(e){return r.indexOf(e.phx_ref)<0}));c.length>0&&(s[e]=t,s[e].metas=c),f.length>0&&(a[e]=o.clone(n),a[e].metas=f)}else s[e]=t})),this.syncDiff(i,{joins:s,leaves:a},n,r)}},{key:"syncDiff",value:function(e,t,n,r){var o=t.joins,i=t.leaves,s=this.clone(e);return n||(n=function(){}),r||(r=function(){}),this.map(o,(function(e,t){var r=s[e];if(s[e]=t,r){var o,i=s[e].metas.map((function(e){return e.phx_ref})),a=r.metas.filter((function(e){return i.indexOf(e.phx_ref)<0}));(o=s[e].metas).unshift.apply(o,function(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(a))}n(e,r,t)})),this.map(i,(function(e,t){var n=s[e];if(n){var o=t.metas.map((function(e){return e.phx_ref}));n.metas=n.metas.filter((function(e){return o.indexOf(e.phx_ref)<0})),r(e,n,t),0===n.metas.length&&delete s[e]}})),s}},{key:"list",value:function(e,t){return t||(t=function(e,t){return t}),this.map(e,(function(e,n){return t(e,n)}))}},{key:"map",value:function(e,t){return Object.getOwnPropertyNames(e).map((function(n){return t(n,e[n])}))}},{key:"clone",value:function(e){return JSON.parse(JSON.stringify(e))}}]),e}(),H=function(){function e(t,n){i(this,e),this.callback=t,this.timerCalc=n,this.timer=null,this.tries=0}return u(e,[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"scheduleTimeout",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.tries=e.tries+1,e.callback()}),this.timerCalc(this.tries+1))}}]),e}()}])},"object"==s(t)&&"object"==s(e)?e.exports=i():(r=[],void 0===(o="function"===typeof(n=i)?n.apply(t,r):n)||(e.exports=o))}).call(this,n(6)(e))},2:function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"===typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var u,c=[],f=!1,l=-1;function h(){f&&u&&(f=!1,u.length?c=u.concat(c):l=-1,c.length&&d())}function d(){if(!f){var e=a(h);f=!0;for(var t=c.length;t;){for(u=c,c=[];++l<t;)u&&u[l].run();l=-1,t=c.length}u=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||f||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},30:function(e,t,n){"use strict";n.r(t);var r=n(13),o=n(0);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e){return function(){var t,n=v(e);if(d()){var r=v(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)}}function c(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function l(e){var t="function"===typeof Map?new Map:void 0;return(l=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return h(e,arguments,v(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),p(r,e)})(e)}function h(e,t,n){return(h=d()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&p(o,n.prototype),o}).apply(null,arguments)}function d(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=!1,m=void 0,g=void 0,b=1e3,k=void 0,w=!1,j=function(e){f(n,e);var t=u(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).name="TrackingChannelError",r}return n}(l(Error)),E=function(e){f(n,e);var t=u(n);function n(e,r){var o;return a(this,n),(o=t.call(this,r)).name="LearningAnalyticsError: ".concat(e),o}return n}(l(Error)),_=function(e){switch(e.type){case"DOMContentLoaded":return"page view";case"activity:ping":return"page activity ping";case"beforeunload":return"page closed";case"editor:focus":return"start editing code";case"guide:submission:passed":return"passed code submission";case"guide:submission:sent":return"submitted code";case"pagefocus":return"page focus";case"pageoutoffocus":return"page out of focus";case"quiz:started":return"quiz started";case"quiz:submitted":return"quiz submitted";case"turbolinks:load":return"page view";case"videojs:end":case"videojs:pause":return"video stopped";case"videojs:play":return"video started";default:return e.type}},O=function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Array.from(document.querySelectorAll(".analytics-param")).reduce((function(e,t){return Object.assign(e,s({},t.dataset.key,t.dataset.value))}),{}),{type:_(e)})},S=function(e){var t=(new Date).getTime();(g||0)<t&&document.hasFocus()&&(document.dispatchEvent(new Event("activity:ping")),g=t+6e4)},T=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;m?m.push("insert",O(t)).receive("error",(function(e){var t=e.reason;Object(o.trackError)(new j(t))})):n<=60?window.setTimeout((function(){e(t)}),500):Object(o.trackError)(new E("Tracking is not available",JSON.stringify(t)))};document.addEventListener("DOMContentLoaded",(function e(){new Promise((function(e,t){var n=new XMLHttpRequest,r=function(e){return function(){n.onload=null,n.onreadystatechange=null,n.abort(),t(new E("Socket Connection Details Request ".concat(e),"Request has been cancelled"))}},o=r("Cancelled");n.open("POST","/api/tracking_token"),n.withCredentials=!0,n.setRequestHeader("Content-Type","application/json");var i=window.setTimeout(r("Timeout"),1e4);n.onload=function(){if(200===n.status){var r=JSON.parse(n.response);e(r)}else{var o=n.responseText||"Request failed",i=n.statusText||"Error",s="Socket Connection Details Request ".concat(i);t(new E(s,o))}},n.onreadystatechange=function(){4===n.readyState&&(window.clearTimeout(i),window.removeEventListener("beforeunload",o),0===n.status)&&t(new E("Socket Connection Details Request Rejection","Request failed prematurely"))},window.addEventListener("beforeunload",o),n.send()})).then((function(t){var n=t.socketUrl,i=t.token;(k=new r.Socket(n,{params:{token:i}})).onClose((function(){m=void 0,k.disconnect(),window.setTimeout(e,b)})),k.connect();var s=k.channel("tracking:events",{});s.join().receive("error",(function(e){var t=e.reason;Object(o.trackError)("Channel Error",new j(t))})),m=s,w=!1,b=1e3})).catch((function(t){if(y)console.warn(t);else{var n=401!==t.status,r="Request failed prematurely"!==t.message,i="Request has been cancelled"===t.message;!w&&n&&r&&!i?(Object(o.trackError)(t),w=!0):console.error(t),b*=2,window.setTimeout(e,b)}}))})),window.addEventListener("beforeunload",(function(){return y=!0})),document.addEventListener("DOMContentLoaded",T),document.addEventListener("activity:ping",T),document.addEventListener("editor:focus",T),document.addEventListener("guide:submission:passed",T),document.addEventListener("guide:submission:sent",T),document.addEventListener("pagefocus",T),document.addEventListener("pageoutoffocus",T),document.addEventListener("quiz:started",T),document.addEventListener("quiz:submitted",T),document.addEventListener("videojs:end",T),document.addEventListener("videojs:pause",T),document.addEventListener("videojs:play",T),window.addEventListener("beforeunload",T),"undefined"!=typeof Turbolinks&&Turbolinks.supported?document.addEventListener("turbolinks:load",T):document.addEventListener("DOMContentLoaded",T),document.addEventListener("visibilitychange",(function(e){document.hidden?document.dispatchEvent(new Event("pageoutoffocus")):document.dispatchEvent(new Event("pagefocus"))})),document.addEventListener("click",S),document.addEventListener("keydown",S),document.addEventListener("mousemove",S),document.addEventListener("mouseup",S),document.addEventListener("touchstart",S),document.addEventListener("wheel",S)},6:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}});
//# sourceMappingURL=learning_analytics-bae94b6ce183442053b8.js.map